# Gitleaks Configuration — FedRAMP IA-5 Secret Detection
# Maps to: IA-5 (Authenticator Management)

title = "FedRAMP Secret Detection Rules"

[extend]
# Use default gitleaks rules as base
useDefault = true

# Additional FedRAMP-specific rules
[[rules]]
id = "fedramp-aws-access-key"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws", "IA-5", "critical"]

[[rules]]
id = "fedramp-aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws_secret_access_key\s*=\s*[A-Za-z0-9/+=]{40}'''
tags = ["aws", "IA-5", "critical"]

[[rules]]
id = "fedramp-private-key"
description = "Private Key File"
regex = '''-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----'''
tags = ["key", "IA-5", "critical"]

[[rules]]
id = "fedramp-database-url"
description = "Database Connection String with Credentials"
regex = '''(?i)(mysql|postgres|mariadb)://[^:]+:[^@]+@'''
tags = ["database", "IA-5", "high"]

[[rules]]
id = "fedramp-jwt-token"
description = "JWT Token"
regex = '''eyJ[A-Za-z0-9_-]{10,}\.eyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}'''
tags = ["jwt", "IA-5", "medium"]

[[rules]]
id = "fedramp-generic-api-key"
description = "Generic API Key Pattern"
regex = '''(?i)(api[_-]?key|apikey)\s*[:=]\s*['"][A-Za-z0-9]{20,}['"]'''
tags = ["api", "IA-5", "high"]

# Allowlist — paths that are expected to contain example/test credentials
[allowlist]
paths = [
  '''target-app/config/config\.inc\.php\.dist''',
  '''target-app/tests/.*''',
  '''evidence/.*''',
  '''demo/.*''',
]

# Known test/example values to ignore
regexes = [
  '''p@ssw0rd''',           # DVWA default (intentional for demo)
  '''password123''',
  '''EXAMPLE''',
  '''changeme''',
]
