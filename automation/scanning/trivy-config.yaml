# Trivy Configuration â€” FedRAMP SI-2 Container Scanning
# Maps to: SI-2 (Flaw Remediation), CM-8 (Component Inventory)

severity:
  - CRITICAL
  - HIGH
  - MEDIUM

scan:
  # Scan container images for OS and library vulnerabilities
  security-checks:
    - vuln
    - misconfig
    - secret

  # Target the DVWA application image
  target: target-app/

  # Skip files that aren't relevant
  skip-dirs:
    - target-app/docs
    - target-app/tests
    - evidence
    - demo

vulnerability:
  # Ignore unfixed vulnerabilities in reports
  ignore-unfixed: false

  # Vulnerability types to scan
  type:
    - os
    - library

misconfig:
  # Check Dockerfiles and Kubernetes manifests
  include:
    - dockerfile
    - kubernetes

  # Policy paths for custom checks
  policy:
    - automation/policies/conftest

output:
  # Format for CI integration
  format: json

  # Output path (overridden by CLI in workflows)
  output: evidence/scan-reports/trivy-latest.json

# SBOM generation for CM-8 compliance
sbom:
  format: cyclonedx
  output: evidence/scan-reports/sbom-latest.json
